language: java
sudo: false
dist: trusty


addons:
    sonarcloud:
        organization: "artsok-github"
        token:
            secure: $SONAR_TOKEN
    github_token:
      secure: $GIT_TOKEN


cache:
  directories:
- '$HOME/.m2/repository'



jdk:
- oraclejdk8

before_script:
    - export DISPLAY=:99.0
    - sh -e /etc/init.d/xvfb start &
    - sleep 3

script:
    - mvn test sonar:sonar
    - bash <(curl -s https://codecov.io/bash)


deploy:
  - provider: script
    script: ".travis/deploy.sh"
    on:
      repo: artsok/api-factory
      branch: master
      jdk: oraclejdk8

  - provider: script
    script: ".travis/deploy.sh"
    skip_cleanup: true
    on:
      repo: sbtqa/api-factory
      tags: true
jdk: oraclejdk8